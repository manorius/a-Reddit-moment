<!DOCTYPE html>
<html>

  <head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Snoocore OAuth Explicit Authentication</title>

  <meta name="description" content="Snoocore - A minimal and complete JavaScript driver for the Reddit API">
  <meta name="author" content="Trevor Senior">
  <link rel="canonical" href="http://tsenior.com/snoocore/snoocore/oauth-implicit.html">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href='//fonts.googleapis.com/css?family=Raleway:400,300,600' type='text/css'>

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="/snoocore/css/normalize.css">
  <link rel="stylesheet" href="/snoocore/css/skeleton.css">
  <link rel="stylesheet" href="/snoocore/css/custom-snoocore.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <!-- <link rel="icon" type="image/png" href="dist/images/favicon.png"> -->

</head>


  <body>

    <div class="wrapper">
      <div class="sidebar"><ul>
  <li><a href="index.html">Home</a></li>

  <li><a href="features.html">Features</a></li>

  <li>Getting Started
    <ul>
      <li><a href="install.html">Install & Include</a></li>
      <li><a href="basicUsage.html">Basic Usage</a></li>
      <li><a href="config.html">Config Options</a></li>
      <li><a href="commonErrors.html">Common Errors</a></li>
    </ul>
  </li>

  <li><a href="login.html">Login</a>
    <ul>
      <li><a href="oauth.html">OAuth</a></li>
      <ul>
	<li><a href="oauth-script.html">Script</a></li>
	<li><a href="oauth-explicit.html">Explicit</a></li>
	<li><a href="oauth-implicit.html">Implicit</a></li>
      </ul>
  </li>
  <li><a href="cookies.html">Cookie</a></li>
    </ul>
  </li>

  <li>Helpers
    <ul>
      <li><a href="listings.html">Listings</a></li>
    </ul>
  </li>

  <li><a href="events.html">Events</a></li>
  <li><a href="fileUpload.html">File Upload</a></li>
  <li><a href="advancedUsage.html">Advanced Usage</a></li>

  <li>Resources
    <ul>
      <li><a href="migration.html">Migration Guide</a></li>
      <li><a href="tests.html">Running Tests</a></li>
      <li><a href="node-vs-browser.html">Node vs. Browser</a></li>
      <li><a href="promises.html">Promises</a></li>
    </ul>
  </li>

</ul>
</div>
      <div class="my-content"><h1 id="authenticating-with-implicit-oauth">Authenticating with Implicit OAuth</h1>

<p>See an example <a href="https://github.com/trevorsenior/snoocore-examples/blob/master/browser/oauth-implicit.html">here</a>.</p>

<p>This should only be used in client side JavaScript applications. It follows roughly the same steps as explicit based OAuth in terms of flow.</p>

<h2 id="supported-apps">Supported Apps</h2>

<p>Implicit based OAuth will only work if you app is an <code>installed</code> application.</p>

<h3 id="initial-config">Initial Config</h3>

<p>In the initial config, give it the OAuth settings for the application:</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Snoocore</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;snoocore&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">reddit</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Snoocore</span><span class="p">({</span>
  <span class="nx">userAgent</span><span class="o">:</span> <span class="s1">&#39;your apps user agent&#39;</span><span class="p">,</span>
  <span class="nx">oauth</span><span class="o">:</span> <span class="p">{</span> 
    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;implicit&#39;</span><span class="p">,</span> <span class="c1">// required when using implicit OAuth</span>
    <span class="nx">mobile</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// defaults to false.</span>
    <span class="nx">consumerKey</span><span class="o">:</span> <span class="s1">&#39;client_id from reddit&#39;</span><span class="p">,</span> 
    <span class="nx">redirectUri</span><span class="o">:</span> <span class="s1">&#39;redirectUri set for your app&#39;</span><span class="p">,</span>
    <span class="nx">scope</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;flair&#39;</span><span class="p">,</span> <span class="s1">&#39;identity&#39;</span> <span class="p">]</span> <span class="c1">// make sure to set all the scopes you need.</span>
  <span class="p">}</span>
<span class="p">});</span>  
</code></pre></div>
<h4 id="oauth.mobile"><code>oauth.mobile</code></h4>

<p>Optional. Set mobile to true to send users to the mobile reddit website for authentication.</p>

<h3 id="getting-the-authentication-url">Getting the authentication URL</h3>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="s1">&#39;foobar&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">authUrl</span> <span class="o">=</span> <span class="nx">reddit</span><span class="p">.</span><span class="nx">getImplicitAuthUrl</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
</code></pre></div>
<p>For CSRF prevention set a <code>state</code>. This field is optional. Read more on this below.</p>

<h3 id="handling-the-response">Handling the response</h3>

<p>After the user visits the URL that <code>reddit.getImplicitAuthUrl</code> generates, they will be presented with the option to Allow or Deny the app. After they allow (or disallow) the application, reddit will redirect the user back to the given <code>redirectUri</code> (set in the initial config)  with the following parameters after the hash tag (It is possible to use <code>window.location.hash</code> to pull the values out after the <code>#</code> in the URL):</p>

<ul>
<li><strong>access_token</strong> - The <code>accessToken</code> (used below)</li>
<li><strong>token_type</strong> - The string &quot;bearer&quot;.</li>
<li><strong>expires_in</strong> - Seconds until the token expires.</li>
<li><strong>scope</strong> - The scope of the token.</li>
<li><strong>state</strong> - should be the same string that was  set in the <code>reddit.getImplicitAuthUrl</code> function (if it was set).</li>
</ul>

<p>For CSRF prevention, check that the <code>state</code> in the url parameters is the same as the <code>state</code> specified when generating the authentication url in <code>reddit.getImplicitAuthUrl</code>.</p>

<h3 id="authenticating-with-the-returned-code">Authenticating with the returned code</h3>

<p>Once the <code>accessToken</code> is pulled from the url <code>accessToken</code>, authenticate with reddit and start making calls on behalf of a user.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">ACCESS_TOKEN</span> <span class="o">=</span> <span class="s1">&#39;??&#39;</span><span class="p">;</span> <span class="cm">/* url parameter &quot;access_token&quot;, see above */</span>
<span class="kd">var</span> <span class="nx">RETURNED_STATE</span> <span class="o">=</span> <span class="s1">&#39;??&#39;</span><span class="p">;</span> <span class="cm">/* url parameter &quot;state&quot;, see above */</span>

<span class="c1">// Exit if the state given is invalid. This is an optional</span>
<span class="c1">// check, but is recommended if you set a state in </span>
<span class="c1">// `reddit.getImplicitAuthUrl`</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">RETURNED_STATE</span> <span class="o">!==</span> <span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;State is not the same as the one set!&#39;</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Authenticate with reddit by passing in the acces_token from the response</span>
<span class="nx">reddit</span><span class="p">.</span><span class="nx">auth</span><span class="p">(</span><span class="nx">ACCESS_TOKEN</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">reddit</span><span class="p">(</span><span class="s1">&#39;/api/v1/me&#39;</span><span class="p">).</span><span class="nx">get</span><span class="p">();</span>
<span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span> <span class="c1">// Log the response</span>
<span class="p">});</span>
</code></pre></div>
<p>Snoocore is now successfully authenticated with OAuth.</p>

<h3 id="de-authenticating">De-Authenticating</h3>

<p>A function <code>reddit.deauth</code> is provided which will revoke the <code>access_token</code> for the current authenticated user.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">deauthPromise</span> <span class="o">=</span> <span class="nx">reddit</span><span class="p">.</span><span class="nx">deauth</span><span class="p">();</span>
</code></pre></div>
<p>Generally it is a good idea to call this everytime the application is finished using the users data.</p>

<h3 id="renewing-authentication">Renewing authentication</h3>

<p>Implicit auth does not have a refresh token. It is possible to listen for an event and have the user re-authenticate with the application. For more information on this view the <a href="events.html">Snoocore Events</a> documentation.</p>
</div>
    </div>

  </body>
</html>
